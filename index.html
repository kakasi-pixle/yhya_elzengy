<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Space Game</title>
<style>
body{margin:0;overflow:hidden;background:#001022;font-family:Arial}
canvas{display:block}
.menu{
 position:fixed;top:0;left:0;width:100%;height:100%;
 background:#001022;display:flex;flex-direction:column;
 align-items:center;justify-content:center;z-index:20
}
.menu h1{color:white;margin-bottom:30px}
.menu button{
 background:#00e6ff;color:#001022;
 border:none;border-radius:14px;
 padding:14px 30px;font-size:22px;
 margin:10px;cursor:pointer
}
#joystick{
 position:fixed;bottom:40px;left:40px;
 width:120px;height:120px;border-radius:50%;
 background:rgba(255,255,255,.2);z-index:5
}
#stick{
 position:absolute;left:40px;top:40px;
 width:40px;height:40px;border-radius:50%;
 background:white
}
#bossHp{
 position:fixed;top:20px;left:50%;
 transform:translateX(-50%);
 width:300px;height:20px;border:2px solid white;display:none
}
#bossHpInner{height:100%;background:red;width:100%}
#retry{
 position:fixed;top:60%;left:50%;
 transform:translate(-50%,-50%);
 background:#00e6ff;color:#001022;
 padding:14px 30px;font-size:22px;
 border-radius:12px;display:none;z-index:30
}
</style>
</head>
<body>

<div id="mainMenu" class="menu">
<h1>مرحبًا في اللعبة</h1>
<button onclick="startGame()">ابدأ</button>
<button onclick="openSkins()">اسكنات</button>
<button onclick="openSettings()">إعدادات</button>
</div>

<div id="skinsMenu" class="menu" style="display:none">
<h1>الاسكنات</h1>
<button onclick="setSkin(0)">سهم</button>
<button onclick="setSkin(1)">مجنحة</button>
<button onclick="setSkin(2)">دائرية</button>
<button onclick="setSkin(3)">ثقيلة</button>
<button onclick="back()">رجوع</button>
</div>

<div id="settingsMenu" class="menu" style="display:none">
<h1>الإعدادات</h1>
<h2 style="color:white">سرعة السفينة: <span id="speedVal">5</span></h2>
<input type="range" min="1" max="10" value="5" id="speedRange">
<button onclick="back()">رجوع</button>
</div>

<canvas id="game"></canvas>
<div id="joystick"><div id="stick"></div></div>
<div id="bossHp"><div id="bossHpInner"></div></div>
<div id="retry" onclick="location.reload()">أعد المحاولة</div>

<script>
const canvas=document.getElementById("game")
const ctx=canvas.getContext("2d")
canvas.width=innerWidth
canvas.height=innerHeight

let gameStarted=false
let skin=0
let speed=5
let stage="enemies"

const imgEnemy=new Image();imgEnemy.src="zen1.png"
const imgBoss=new Image();imgBoss.src="zen3.png"
const imgAlly=new Image();imgAlly.src="zen4.png"
const imgWin=new Image();imgWin.src="zen.png"

document.getElementById("speedRange").oninput=e=>{
 speed=+e.target.value
 document.getElementById("speedVal").innerText=speed
}

function startGame(){
 document.getElementById("mainMenu").style.display="none"
 gameStarted=true
}

function openSkins(){
 document.getElementById("mainMenu").style.display="none"
 document.getElementById("skinsMenu").style.display="flex"
}

function openSettings(){
 document.getElementById("mainMenu").style.display="none"
 document.getElementById("settingsMenu").style.display="flex"
}

function back(){
 document.getElementById("skinsMenu").style.display="none"
 document.getElementById("settingsMenu").style.display="none"
 document.getElementById("mainMenu").style.display="flex"
}

function setSkin(s){skin=s;back()}

const player={x:canvas.width/2,y:canvas.height-150,size:35}
let jx=0,jy=0,active=false

const joy=document.getElementById("joystick")
const stick=document.getElementById("stick")

joy.addEventListener("touchstart",()=>active=true)
joy.addEventListener("touchend",()=>{
 active=false;jx=jy=0
 stick.style.left="40px";stick.style.top="40px"
})
joy.addEventListener("touchmove",e=>{
 if(!active)return
 let r=joy.getBoundingClientRect()
 let x=e.touches[0].clientX-r.left-60
 let y=e.touches[0].clientY-r.top-60
 let d=Math.min(40,Math.hypot(x,y))
 let a=Math.atan2(y,x)
 jx=Math.cos(a)*d/40
 jy=Math.sin(a)*d/40
 stick.style.left=40+jx*40+"px"
 stick.style.top=40+jy*40+"px"
})

function drawShip(){
 ctx.save()
 ctx.translate(player.x,player.y)
 ctx.fillStyle="#00e6ff"

 if(skin===0){
  ctx.beginPath()
  ctx.moveTo(0,-40)
  ctx.lineTo(25,30)
  ctx.lineTo(0,15)
  ctx.lineTo(-25,30)
  ctx.closePath()
  ctx.fill()
 }

 if(skin===1){
  ctx.beginPath()
  ctx.moveTo(0,-35)
  ctx.lineTo(15,10)
  ctx.lineTo(35,25)
  ctx.lineTo(0,15)
  ctx.lineTo(-35,25)
  ctx.lineTo(-15,10)
  ctx.closePath()
  ctx.fill()
 }

 if(skin===2){
  ctx.beginPath()
  ctx.arc(0,0,28,0,Math.PI*2)
  ctx.fill()
 }

 if(skin===3){
  ctx.fillRect(-25,-25,50,50)
 }

 ctx.restore()
}

function update(){
 if(!gameStarted)return

 player.x+=jx*speed*2
 player.y+=jy*speed*2

 player.x=Math.max(player.size,Math.min(canvas.width-player.size,player.x))
 player.y=Math.max(player.size,Math.min(canvas.height-player.size,player.y))
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height)
 if(!gameStarted)return
 drawShip()
}

function loop(){
 update()
 draw()
 requestAnimationFrame(loop)
}
loop()
</script>
</body>
</html>
