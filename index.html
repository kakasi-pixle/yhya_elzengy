<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>لعبة السفينة</title>
<style>
  body { margin: 0; overflow: hidden; background: #000; }
  canvas { display: block; background: #003; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// مسلسلتك
let player = {
  x: canvas.width / 2,
  y: canvas.height - 100,
  size: 20
};

// أعداء
let enemies = [];
let shots = [];

for (let i = 0; i < 10; i++) {
  enemies.push({
    x: Math.random() * (canvas.width - 40) + 20,
    y: Math.random() * (canvas.height / 2),
    size: 30,
    alive: true
  });
}

let gameWon = false;

// تحريك بالسحب
let pointer = { x: player.x, y: player.y };
canvas.addEventListener("mousemove", (e) => {
  pointer.x = e.clientX;
  pointer.y = e.clientY;
});
canvas.addEventListener("touchmove", (e) => {
  pointer.x = e.touches[0].clientX;
  pointer.y = e.touches[0].clientY;
});

// اطلاق الطلقة
canvas.addEventListener("click", shoot);
canvas.addEventListener("touchstart", shoot);

function shoot() {
  shots.push({
    x: player.x,
    y: player.y,
    size: 25,
    dy: -6
  });
}

function update() {
  // تحريك اللاعب نحو اللمس
  player.x += (pointer.x - player.x) * 0.2;
  player.y += (pointer.y - player.y) * 0.2;

  // تحريك الأعداء نحونا
  enemies.forEach(e => {
    if (e.alive) {
      let dx = player.x - e.x;
      let dy = player.y - e.y;
      let dist = Math.sqrt(dx * dx + dy * dy);
      if (dist > 1) {
        e.x += (dx / dist) * 1;
        e.y += (dy / dist) * 1;
      }
    }
  });

  // تحريك الطلقات واكتشاف التصادم
  shots.forEach((s, i) => {
    s.y += s.dy;
    enemies.forEach(e => {
      if (e.alive && Math.abs(s.x - e.x) < e.size && Math.abs(s.y - e.y) < e.size) {
        e.alive = false;
        shots.splice(i, 1);
      }
    });
  });

  // فحص الفوز
  if (enemies.every(e => !e.alive)) gameWon = true;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // رسم اللاعب (مثلث)
  ctx.fillStyle = "lime";
  ctx.beginPath();
  ctx.moveTo(player.x, player.y - player.size);
  ctx.lineTo(player.x - player.size, player.y + player.size);
  ctx.lineTo(player.x + player.size, player.y + player.size);
  ctx.fill();

  // رسم الأعداء (مربعات)
  enemies.forEach(e => {
    if (e.alive) {
      ctx.fillStyle = "red";
      ctx.fillRect(e.x - e.size/2, e.y - e.size/2, e.size, e.size);
    }
  });

  // رسم الطلقات
  shots.forEach(s => {
    ctx.fillStyle = "yellow";
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
    ctx.fill();
  });

  // لو كسبت
  if (gameWon) {
    ctx.fillStyle = "white";
    ctx.font = "60px Arial";
    ctx.textAlign = "center";
    ctx.fillText("لقد فزت!", canvas.width/2, canvas.height/2 - 100);

    let img = new Image();
    img.src = "https://qu.ax/tMWYs";
    img.onload = () => {
      ctx.drawImage(img, canvas.width/2 - 150, canvas.height/2 - 50, 300, 300);
    };
  }
}

function loop() {
  if (!gameWon) {
    update();
    draw();
    requestAnimationFrame(loop);
  } else {
    draw(); // رسم شاشة الفوز
  }
}

loop();
</script>

</body>
</html>
